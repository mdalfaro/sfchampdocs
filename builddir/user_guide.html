

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>User Guide &mdash; SF-CHAMP 6.1.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Model Calibration &amp; Validation" href="model_calibration_and_validation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SF-CHAMP
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro_overview.html">Introduction &amp; Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_structure_and_flow.html">Model Structure &amp; Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="activity_demand_models.html">Activity Demand Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="network_supply_models.html">Network Supply Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_inputs.html">Model Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_outputs.html">Model Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_calibration_and_validation.html">Model Calibration &amp; Validation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-a-model">Running a Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preparing-inputs">Preparing Inputs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#land-use-coding">Land Use Coding</a></li>
<li class="toctree-l4"><a class="reference internal" href="#taz-data-processor">TAZ Data Processor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#population-synthesizer">Population Synthesizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-coding">Network Coding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-setup">Run Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SF-CHAMP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>User Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/user_guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="running-a-model">
<h2>Running a Model<a class="headerlink" href="#running-a-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preparing-inputs">
<h3>Preparing Inputs<a class="headerlink" href="#preparing-inputs" title="Permalink to this headline">¶</a></h3>
<div class="section" id="land-use-coding">
<h4>Land Use Coding<a class="headerlink" href="#land-use-coding" title="Permalink to this headline">¶</a></h4>
<p>See <a class="reference external" href="http://intranet2.sfcta.org/Modeling/LandUseProjections">Land Use Projections</a> for documentation on the current set of land use projections we use.</p>
<p>See <a class="reference external" href="http://intranet2.sfcta.org/Modeling/DisaggregateInputOutputKey#TAZDATA_dbf">Disaggregate Input Output Key</a>  for the fields in the land use input file, tazdata.dbf.</p>
</div>
<div class="section" id="taz-data-processor">
<h4>TAZ Data Processor<a class="headerlink" href="#taz-data-processor" title="Permalink to this headline">¶</a></h4>
<p>See <a class="reference external" href="http://intranet2.sfcta.org/Modeling/TAZDataProcessor">TAZ Data Processor</a> for information about the TAZ Data Processor. Trivial modifications were made to the process for CHAMP 4.3 Fury (Noted in TAZDataProcessor).</p>
</div>
<div class="section" id="population-synthesizer">
<h4>Population Synthesizer<a class="headerlink" href="#population-synthesizer" title="Permalink to this headline">¶</a></h4>
<p>See <a class="reference external" href="http://intranet2.sfcta.org/Modeling/PopulationSynthesizer">Population Synthesizer</a> for information about the Population Synthesizer.No modifications were made to the code or configuration for CHAMP 4.3 Fury.</p>
</div>
<div class="section" id="network-coding">
<h4>Network Coding<a class="headerlink" href="#network-coding" title="Permalink to this headline">¶</a></h4>
<p>See <a class="reference external" href="http://intranet2.sfcta.org/Modeling/NetworkCodingGuidelines">Network Coding Guidelines</a> for general network coding (this page is fairly lacking in content and should be deprecated?).</p>
<p>See <a class="reference external" href="http://intranet2.sfcta.org/Modeling/NetworkWrangler">Network Wrangler</a> for more information about the tool we use to build networks from a set of projects.</p>
</div>
</div>
<div class="section" id="run-setup">
<h3>Run Setup<a class="headerlink" href="#run-setup" title="Permalink to this headline">¶</a></h3>
<p>Including <a class="reference external" href="http://intranet2.sfcta.org/Modeling/SetupNewModelRun">Setup New Model Run</a>.</p>
</div>
<div class="section" id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>If a model run crashes, first step is to look at the DOS window and see what it told you and also check feedback.rpt in the run directory, which also gives you a hint about what is going on, what ran correctly, what isn’t working correctly. Another good clue often comes from looking at the run directory or the current transit assignment subdirectory, sorted by time.</p>
<ul class="simple">
<li><p>The first thing to check is whether we’ve run out of space on the X: drive… (really this is something to check before starting a model, but we all forget sometimes.)</p></li>
<li><p>If a Cube script fails (return code 2), then find the appropriate print log files by sorting the run directory by time, and looking for F(, which signifies where the failure in cube occurs.</p></li>
<li><p>Sometimes a cube script will fail because a previous step in the model chain didn’t work out correct. For example, if the step for averaging trip tables doesn’t work, this is usually because one or all of the model cores failed to run, so the appropriate input files weren’t there to average.</p></li>
<li><p>The walk skims part of pre-processing can be a little bit fragile, especially whenever it needs to use arcpy. TARAVAL needs to have a GIS license for this step; we usually keep an ArcMap window open to make sure it can get one, but check if this has been closed. If arcpy complains about trying to add a field which already exists (e.g. gislen) that probably means it’s trying to run the same script twice – either you can skip ahead to the completion of that script or you need to roll back to earlier in the model run and undo the addition of those fields (if you need the original FREEFLOW.NET, it’s in inputshwy). If arcpy complains about the <code class="docutils literal notranslate"><span class="pre">VALUETOLL_</span></code> field, the most likely problem is an out-of-date version of the TI_Ramps project – the current version of that project excludes that field.</p></li>
<li><p>Occasionally the highway network gets built with some field errors that cause model crashes. Check that all links have MTYPE set to either SF or MTC and that all links have distance&gt;0.</p></li>
<li><p>If the core has failed, check to make sure there was enough space locally on the core machine (i.e. MINNA or ZOE or BONECRUSHER) to write the outputs and also check that the X-drive wasn’t full. This is also often accompanied by a pop-up “delay write failure”.</p></li>
<li><p>Another possible reason the core could have failed was that it couldn’t find the machine it was supposed to send the core to (i.e. “calling BONECRUSHER, couldn’t find BONECRUSHER”). There are two possible reasons for this: (1) bonecrusher has shut itself down. you can test this by trying to VNC or ping bonecrusher; (2) the champ client isn’t running on bonecrusher, or it is running with an incompatible version of Python. Check bonecrusher to see if the correct champ client is running. We also have sometimes had problems with dispatching to a champ client because of the Windows firewall – if a modeling machine is new or has recently been upgraded, that’s a good thing to double-check.</p></li>
<li><p>Occasionally we’ve had trouble importing Wrangler, specifically the transitAssignmentData module. Sometimes this can be solved by deleting the .pyc files (the compiled python scripts); sometimes this has actually masked other issues because Wrangler automatically tries both transitAssignmentData and TransitAssignmentData, and isn’t currently setup to report why one fails if it tries the other.</p></li>
<li><p>In Cube 5, we had a lot of trouble with crashes during transit assignment and skimming. I think (cross fingers) that’s mostly solved in Cube 6, but in case it’s not, here’s a bit about what tended to happen and how to fix it. Sometimes one of the cluster nodes would either not respond, or would be skipped over, causing the master process to keep waiting for a non-existent process to finish – classic symptom is a “waiting for files to be created” window with all but one box checked, that lasts for more than 5 or 10 minutes. To re-start, you want to make sure to run every script that hasn’t already run, but not run the ones which have – check for which output files have been created, then edit the trnAssign.jset or trnSkim.jset file to remove the scripts that have already run and restart the model with goto statements directing it to start with that jset. Sometimes you can be clever and restart one of these without actually stopping the main model process – if the model has hung waiting for CHAMP4.script.end, you can just run the CHAMP4.script from the command line and create the .script.end file which just contains the return code (hopefully 1) and the name of the PRN file. Once the .script.end file has been created, the master process will recongnize it and resume working.</p></li>
<li><p>The bike model sometimes hangs on bike assignment or (less commonly) bike logsums. As far as I can tell, the issue is somewhere in python’s multiprocessing package, and what seems to happen is that the subprocesses all finish but the message doesn’t get back to the main process. I’m not sure what the solution is to this one.</p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="model_calibration_and_validation.html" class="btn btn-neutral float-left" title="Model Calibration &amp; Validation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, contributing authors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>